[
  {
    "objectID": "unit1-lect3.html#agenda",
    "href": "unit1-lect3.html#agenda",
    "title": "Simulation basics",
    "section": "Agenda",
    "text": "Agenda\n\nBrief review of simulation basics (we will expand on this later)\nInverse transform sampling for joint distributions\nMotivation for causal inference (if we have time to start)"
  },
  {
    "objectID": "unit1-lect3.html#inverse-transform-sampling",
    "href": "unit1-lect3.html#inverse-transform-sampling",
    "title": "Simulation basics",
    "section": "Inverse transform sampling",
    "text": "Inverse transform sampling\nKey result:\n\nSuppose \\(U \\sim Unif(0,1)\\)\nSuppose \\(F_X(\\cdot)\\) is a cumulative distribution function (cdf) for (arbitrary) \\(X\\)\n\ni.e., \\(F_X(x) = P(X\\leq  x)\\)\n\nSuppose \\(F_X^{-1}(\\cdot)\\) is the inverse cdf\n\ni.e., \\(F_{X}^{-1}(u) = \\Big\\{x \\ \\text{ s.t. } \\  P(X\\leq  x) = u\\Big\\}.\\)"
  },
  {
    "objectID": "unit1-lect3.html#inverse-transform-sampling-1",
    "href": "unit1-lect3.html#inverse-transform-sampling-1",
    "title": "Simulation basics",
    "section": "Inverse transform sampling",
    "text": "Inverse transform sampling\n\nDefine \\(Z=F_{X}^{-1}(U)\\)\n\n\nThen:\n\n\n\\(F_{Z}(x) = P\\Big(F_{X}^{-1}(U)\\leq  x\\Big)=F_X(x)\\).\n\ni.e., \\(Z=F_{X}^{-1}(U)\\) is distributed the same as \\(X\\)."
  },
  {
    "objectID": "unit1-lect3.html#inverse-transform-sampling-2",
    "href": "unit1-lect3.html#inverse-transform-sampling-2",
    "title": "Simulation basics",
    "section": "Inverse Transform sampling",
    "text": "Inverse Transform sampling"
  },
  {
    "objectID": "unit1-lect3.html#inverse-transform-sampling-3",
    "href": "unit1-lect3.html#inverse-transform-sampling-3",
    "title": "Simulation basics",
    "section": "Inverse transform sampling",
    "text": "Inverse transform sampling\nWhy does this work?\n\nThe key property of \\(Unif(0,1)\\) variables (e.g., \\(U\\)) is:\n\n\\(P(U\\leq  u)=u\\) for \\(u\\in[0,1]\\).\n\nNow consider some r.v. \\(Y\\) with cdf \\(F_Y\\) taking values on the real number line, \\(\\mathbb{R}\\).\n\nLet’s say it is a standard normal variable \\(\\mathcal{N}(0,1)\\). (disclaimer, normal variables don’t have a closed form cdf)."
  },
  {
    "objectID": "unit1-lect3.html#inverse-transform-sampling-4",
    "href": "unit1-lect3.html#inverse-transform-sampling-4",
    "title": "Simulation basics",
    "section": "Inverse transform sampling",
    "text": "Inverse transform sampling\n-Thus (and remembering that \\(F_Y^{-1}\\) is monotonic increasing):\n\n\\(P\\Big(F_Y^{-1}(U)\\leq  y\\Big)=P\\Big(U\\leq  F_Y(y)\\Big) = F_Y(y).\\)\ne.g., \\(P\\Big(F_Y^{-1}(U)\\leq  -1.96\\Big) = P(U\\leq  0.025) = 0.025 = P(Y\\leq -1.96)\\)\ne.g., \\(P\\Big(F_Y^{-1}(U)\\leq  0\\Big) = P(U\\leq 0.5) = 0.5 = P(Y\\leq 0)\\)"
  },
  {
    "objectID": "unit1-lect3.html#inverse-transform-sampling-5",
    "href": "unit1-lect3.html#inverse-transform-sampling-5",
    "title": "Simulation basics",
    "section": "Inverse transform sampling",
    "text": "Inverse transform sampling\n\nU&lt;-runif(10000, 0,1)\nhead(U, 25)\n\n [1] 0.7516654 0.7550282 0.6794609 0.7243687 0.8472480 0.9834753 0.7419241\n [8] 0.3148803 0.8193543 0.8630167 0.5155631 0.3711469 0.6978833 0.4830945\n[15] 0.6152632 0.9462419 0.9177134 0.5725926 0.3438755 0.1916295 0.1264009\n[22] 0.7358178 0.4734793 0.0273331 0.7214045\n\n\n\nZ&lt;-qnorm(U, 0, 1)\nhead(Z, 25)\n\n [1]  0.67973970  0.69039852  0.46619196  0.59586919  1.02470167  2.13148192\n [7]  0.64928878 -0.48206391  0.91290696  1.09397333  0.03902088 -0.32881715\n[13]  0.51832225 -0.04238839  0.29306363  1.60945784  1.38985411  0.18297872\n[19] -0.40190886 -0.87190726 -1.14357065  0.63050463 -0.06652652 -1.92151988\n[25]  0.58701890"
  },
  {
    "objectID": "unit1-lect3.html#inverse-transform-sampling-6",
    "href": "unit1-lect3.html#inverse-transform-sampling-6",
    "title": "Simulation basics",
    "section": "Inverse transform sampling",
    "text": "Inverse transform sampling"
  },
  {
    "objectID": "unit1-lect3.html#sampling-for-joint-distributions",
    "href": "unit1-lect3.html#sampling-for-joint-distributions",
    "title": "Simulation basics",
    "section": "Sampling for joint distributions",
    "text": "Sampling for joint distributions\n\nConsider a collection of variables (a vector) \\(\\mathbf{X}\\equiv(X_1,\\dots, X_p)\\sim P.\\)\nSuppose we consider a specific \\(P\\). How do we simulate a vector \\(\\mathbf{Z}\\sim P.\\)"
  },
  {
    "objectID": "unit1-lect3.html#sampling-for-joint-distributions-1",
    "href": "unit1-lect3.html#sampling-for-joint-distributions-1",
    "title": "Simulation basics",
    "section": "Sampling for joint distributions",
    "text": "Sampling for joint distributions\n\nRecall that the distribution \\(P\\) is specified by the joint density function \\(f_{\\mathbf{X}}(x_1, \\dots, x_p)\\).\nA joint density function can be factorized as a product of conditional density functions:\\[f_{\\mathbf{X}}(x_1, \\dots, x_p) = \\prod\\limits_{k=1}^p f_{X_k \\mid X_{k-1}, \\dots, X_1}(x_k \\mid x_{k-1}, \\dots, x_1).\\]\n\ne.g., \\(f(x_1, x_2) = f(x_1 \\mid x_2)f(x_2)\\)."
  },
  {
    "objectID": "unit1-lect3.html#sampling-from-joint-distributions",
    "href": "unit1-lect3.html#sampling-from-joint-distributions",
    "title": "Simulation basics",
    "section": "Sampling from joint distributions",
    "text": "Sampling from joint distributions\nSuppose:\n\n\\(U_k \\sim Unif(0,1)\\) are mutually independent, for \\(k=1,\\dots, p\\).\n\\(F_k(\\cdot)\\) is a cdf for \\(X_k\\) given \\(X_1,\\dots, X_{k-1}.\\)\n\ni.e., \\(F_k(x_k \\mid x_{k-1}, \\dots, x_1) = P(X_k\\leq x_k \\mid x_{k-1}, \\dots, x_1).\\)\n\n\\(F_k^{-1}(\\cdot)\\) is the inverse cdf, i.e., \\[\\begin{align}& F_{k}^{-1}(u \\mid x_{k-1}, \\dots, x_1) \\nonumber \\\\  =& \\Big\\{x_k \\ \\text{ s.t. } \\  P(X_k\\leq x_k \\mid x_{k-1}, \\dots, x_1) = u\\Big\\}. \\nonumber \\end{align}\\]"
  },
  {
    "objectID": "unit1-lect3.html#sampling-from-joint-distributions-1",
    "href": "unit1-lect3.html#sampling-from-joint-distributions-1",
    "title": "Simulation basics",
    "section": "Sampling from joint distributions",
    "text": "Sampling from joint distributions\n\nDefine \\(Z_1=F_{1}^{-1}(U_1)\\)\nIteratively define (from \\(k=2,\\dots, p\\)) \\[Z_k=F^{-1}_k(U_k \\mid Z_{k-1}, \\dots, Z_1)\\]\n\n\nThen:\n\n\n\\(F_{\\mathbf{Z}}(\\mathbf{x}) =F_{\\mathbf{X}}(\\mathbf{x})\\).\n\ni.e., \\(\\mathbf{Z}\\) is distributed the same as \\(\\mathbf{X}\\)."
  },
  {
    "objectID": "unit1-lect3.html#sampling-from-joint-distributions-2",
    "href": "unit1-lect3.html#sampling-from-joint-distributions-2",
    "title": "Simulation basics",
    "section": "Sampling from joint distributions",
    "text": "Sampling from joint distributions\nExample 1: \\(\\mathbf{X}=(X_1, X_2)\\), each binary \\(\\{0, 1\\}\\) variables.\n\n\\(P(X_1=1)=0.5\\),\n\\(P(X_2 =1 \\mid X_1=x_1 )= \\begin{cases} 0.25 \\text{ if } x_1=1 \\\\ 0.75 \\text{ if } x_1=0 \\end{cases}\\)\n\n\nThen:\n\n\n\\(Z_1=\\begin{cases} 1 & \\text{ if } U_1\\leq 0.5 \\\\ 0 & \\text{ if } U_1\\geq 0.5 \\end{cases}\\)\n\\(Z_2=\\begin{cases} 1 & \\text{ if } U_2\\leq 0.25 \\text{ and } Z_1=1 \\\\ 0 & \\text{ if } U_2 \\geq 0.25 \\text{ and } Z_1=1 \\\\ 1 & \\text{ if } U_2\\leq 0.75 \\text{ and } Z_1=0   \\\\ 0 & \\text{ if } U_2\\geq 0.75 \\text{ and } Z_1=0 \\end{cases}.\\)"
  },
  {
    "objectID": "unit1-lect3.html#sampling-from-joint-distributions-3",
    "href": "unit1-lect3.html#sampling-from-joint-distributions-3",
    "title": "Simulation basics",
    "section": "Sampling from joint distributions",
    "text": "Sampling from joint distributions\n\nU1&lt;-runif(10000, 0,1)\nU2&lt;-runif(10000, 0,1)\nZ1 = qbinom(U1, 1, 0.5)\nZ2 = qbinom(U2, 1, 0.75 - Z1*0.5)\nprop.table(table(Z1))[2]\n\n     1 \n0.4975 \n\nprop.table(table(Z1, Z2), margin=1)[2, ]\n\n        0         1 \n0.7449246 0.2550754"
  },
  {
    "objectID": "unit1-lect3.html#sampling-from-joint-distributions-4",
    "href": "unit1-lect3.html#sampling-from-joint-distributions-4",
    "title": "Simulation basics",
    "section": "Sampling from joint distributions",
    "text": "Sampling from joint distributions\nExample 2:\n\n\\(\\mathbf{X}=(X_1, X_2)\\), each normally distributed variables.\nSuppose:\n\n\\(X_1 \\sim \\mathcal{N}(0,1)\\)\n\\(X_2 \\sim \\mathcal{N}(\\beta_0 + \\beta_1X_1 + \\beta_2X^2,\\sigma^2)\\)\n\\((\\beta_0, \\beta_1, \\beta_2, \\sigma^2) = (0, 0.5, 2, 4)\\)\n\nLet \\(\\Phi^{-1}\\) be the inverse cdf for the standard normal."
  },
  {
    "objectID": "unit1-lect3.html#sampling-from-joint-distributions-5",
    "href": "unit1-lect3.html#sampling-from-joint-distributions-5",
    "title": "Simulation basics",
    "section": "Sampling from joint distributions",
    "text": "Sampling from joint distributions\n\n\\((\\beta_0, \\beta_1, \\beta_2, \\sigma^2) = (0, 0.5, 2, 4)\\)\n\n\nThen:\n\n\n\\(Z_1= \\Phi^{-1}(U_1)\\)\n\\(Z_2= 2\\Phi^{-1}(U_2) + (0.5 Z_1+ 2Z_1^2)\\)"
  },
  {
    "objectID": "unit1-lect3.html#sampling-from-joint-distributions-6",
    "href": "unit1-lect3.html#sampling-from-joint-distributions-6",
    "title": "Simulation basics",
    "section": "Sampling from joint distributions",
    "text": "Sampling from joint distributions\n\nU1&lt;-runif(100, 0,1)\nU2&lt;-runif(100, 0,1)\nZ1 = qnorm(U1, 0, 1)\nZ2 = qnorm(U2, 0.5*Z1 + 2*Z1^2, 2)\nlm(Z2~Z1 + I(Z1^2))\n\n\nCall:\nlm(formula = Z2 ~ Z1 + I(Z1^2))\n\nCoefficients:\n(Intercept)           Z1      I(Z1^2)  \n    -0.2483       0.5120       2.0194"
  },
  {
    "objectID": "unit1-lect3.html#sampling-from-joint-distributions-7",
    "href": "unit1-lect3.html#sampling-from-joint-distributions-7",
    "title": "Simulation basics",
    "section": "Sampling from joint distributions",
    "text": "Sampling from joint distributions"
  },
  {
    "objectID": "unit1-lect3.html#sampling-from-sampling-distributions",
    "href": "unit1-lect3.html#sampling-from-sampling-distributions",
    "title": "Simulation basics",
    "section": "Sampling from sampling distributions",
    "text": "Sampling from sampling distributions\n\nConsider a sample of size \\(n\\), \\(\\mathbf{X}_n \\equiv (X_1,\\dots, X_n)\\).\nWhen data are i.i.d, \\(f(x_k \\mid x_{k-1}, \\dots, x_1) = f(x_k)\\).\nThis means that simulating samples is easy!"
  },
  {
    "objectID": "unit1-lect3.html#sampling-from-sampling-distributions-1",
    "href": "unit1-lect3.html#sampling-from-sampling-distributions-1",
    "title": "Simulation basics",
    "section": "Sampling from sampling distributions",
    "text": "Sampling from sampling distributions\nHere we simulate a single sample of size \\(n=100\\).\n\nn=100\nU1&lt;-runif(n)\nU2&lt;-runif(n, 0,1)\nZ1 = qnorm(U1, 0, 1)\nZ2 = qnorm(U2, 0.5*Z1 + 2*Z1^2, 2)\nfit &lt;- lm(Z2 ~ Z1 + I(Z1^2), data = df)\ncoef(fit)[\"I(Z1^2)\"]\n\n I(Z1^2) \n2.019383 \n\nsummary(fit)$coefficients[\"I(Z1^2)\", \"Std. Error\"]\n\n[1] 0.0971504"
  },
  {
    "objectID": "unit1-lect3.html#sampling-from-sampling-distributions-2",
    "href": "unit1-lect3.html#sampling-from-sampling-distributions-2",
    "title": "Simulation basics",
    "section": "Sampling from sampling distributions",
    "text": "Sampling from sampling distributions\nHere we simulate a 1000 samples of size \\(n=100\\).\n\nlibrary(dplyr)\nn=100\nB=10000\nU1 = runif(n*B, 0,1)\nU2 = runif(n*B, 0,1)\nZ1 = qnorm(U1, 0, 1) %&gt;% matrix(nrow=n, ncol=B)\nZ2 = qnorm(U2, 0.5*Z1 + 2*Z1^2, 2) %&gt;% matrix(nrow=n, ncol=B)\nbeta_2_hat = rep(NA, B)\nbeta_0_hat &lt;- rep(NA, B)\nbeta_1_hat &lt;- rep(NA, B)\nse_beta0 = rep(NA, B)\nse_beta1 = rep(NA, B)\nse_beta2 = rep(NA, B)\nfor(i in 1:B){\n  df&lt;-data.frame(Z1=Z1[,i], Z2=Z2[,i])\n  fit &lt;- lm(Z2 ~ Z1 + I(Z1^2), data=df)\n  beta_0_hat[i] &lt;- coef(fit)[\"(Intercept)\"]\n  se_beta0[i] &lt;- summary(fit)$coefficients[\"(Intercept)\", \"Std. Error\"]\n  beta_1_hat[i] &lt;- coef(fit)[\"Z1\"]\n  se_beta1[i] &lt;- summary(fit)$coefficients[\"Z1\", \"Std. Error\"]\n  beta_2_hat[i] &lt;- coef(fit)[\"I(Z1^2)\"]\n  se_beta2[i] &lt;- summary(fit)$coefficients[\"I(Z1^2)\", \"Std. Error\"]\n}\nmean(beta_0_hat - 0)\n\n[1] 0.002789423\n\nmean(se_beta0-sd(beta_0_hat))\n\n[1] -0.002091661\n\nmean(beta_1_hat - 0.5)\n\n[1] -0.0001545926\n\nmean(se_beta1-sd(beta_1_hat))\n\n[1] -0.002606927\n\nmean(beta_2_hat - 2)\n\n[1] -0.00212436\n\nmean(se_beta2-sd(beta_2_hat))\n\n[1] -0.003022693"
  },
  {
    "objectID": "unit1-lect3.html#sampling-from-sampling-distributions-3",
    "href": "unit1-lect3.html#sampling-from-sampling-distributions-3",
    "title": "Simulation basics",
    "section": "Sampling from sampling distributions",
    "text": "Sampling from sampling distributions"
  },
  {
    "objectID": "unit1-lect3.html#sampling-from-sampling-distributions-4",
    "href": "unit1-lect3.html#sampling-from-sampling-distributions-4",
    "title": "Simulation basics",
    "section": "Sampling from sampling distributions",
    "text": "Sampling from sampling distributions"
  }
]